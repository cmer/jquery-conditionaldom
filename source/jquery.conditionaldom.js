// Generated by CoffeeScript 1.3.3

/*
ConditionalDom is a jQuery plugin that makes it easy to conditionally
execute simple actions on DOM elements.

For example, if the current user is an administrator, you might want to
show a certain DIV, but hide it when the user is not an administrator.

@name conditionaldom
@version 0.3.1
@date 7/25/2012
@requires jQuery v1.2.3+
@author Carl Mercier
@license MIT License - http://www.opensource.org/licenses/mit-license.php

For usage and examples, visit:
http://github.com/cmer/jquery-conditionaldom/

Copyright (c) 2012, Carl Mercier (c -[at]- cmer [*dot*] me)
*/


(function() {

  (function($) {
    return $.fn.conditionalDom = function(options) {
      var _this = this;
      if (options == null) {
        options = {};
      }
      options['selector'] || (options['selector'] = '.conditionalDom');
      options['true_action'] || (options['true_action'] = function($e) {
        $e.children().insertAfter($e);
        return $e.remove();
      });
      options['false_action'] || (options['false_action'] = function($e) {
        return $e.remove();
      });
      return this.find("" + options['selector'] + ":not(.executed), " + options['selector'] + ".multi").each(function(index, e) {
        var $e, action, code, falseAction, result, trueAction;
        $e = $(e);
        if (e.getAttribute("data-if") || e.getAttribute("data-unless")) {
          code = "(" + (e.getAttribute("data-if") || e.getAttribute("data-unless")) + ")";
          trueAction = e.getAttribute("data-true-action") || options["true_action"];
          falseAction = e.getAttribute("data-false-action") || options["false_action"];
          if (e.getAttribute("data-if")) {
            code = "if " + code;
          } else if ($e.getAttribute("data-unless")) {
            code = "if (!" + code + ")";
          }
          code += "{ true } else { false }";
          result = eval(code);
          action = result === true ? trueAction : falseAction;
          if ($.isFunction(action)) {
            action($e);
          } else {
            eval(action);
          }
          $e.addClass('executed');
          return true;
        }
      });
    };
  })(jQuery);

}).call(this);
