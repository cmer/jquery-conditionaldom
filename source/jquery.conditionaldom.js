// Generated by CoffeeScript 1.3.3

/*
ConditionalDom is a jQuery plugin that makes it easy to conditionally
execute simple actions on DOM elements.

For example, if the current user is an administrator, you might want to
show a certain DIV, but hide it when the user is not an administrator.

@name conditionaldom
@version 0.3.0
@date 7/25/2012
@requires jQuery v1.2.3+
@author Carl Mercier
@license MIT License - http://www.opensource.org/licenses/mit-license.php

For usage and examples, visit:
http://github.com/cmer/jquery-conditionaldom/

Copyright (c) 2012, Carl Mercier (c -[at]- cmer [*dot*] me)
*/


(function() {

  (function($) {
    return $.fn.conditionalDom = function(options) {
      var _this = this;
      if (options == null) {
        options = {};
      }
      options['selector'] || (options['selector'] = '.conditionalDom');
      return this.find("" + options['selector'] + ":not(.executed), " + options['selector'] + ".multi").each(function(index, e) {
        var $e, action, code, falseAction, result, trueAction;
        $e = $(e);
        if ($e.data("if") || $e.data("unless")) {
          code = "(" + ($e.data("if") || $e.data("unless")) + ")";
          trueAction = $e.data("true-action") || options["true_action"] || "$e.replaceWith($e.html());";
          falseAction = $e.data("false-action") || options["false_action"] || "$e.remove();";
          if ($e.data("if")) {
            code = "if " + code;
          } else if ($e.data("unless")) {
            code = "if (!" + code + ")";
          }
          code += "{ true } else { false }";
          result = eval(code);
          action = result === true ? trueAction : falseAction;
          if ($.isFunction(action)) {
            action($e);
          } else {
            eval(action);
          }
          $e.addClass('executed');
          return true;
        }
      });
    };
  })(jQuery);

}).call(this);
